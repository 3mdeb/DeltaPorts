--- Makefile.orig	2016-12-27 15:49:22 UTC
+++ Makefile
@@ -39,7 +39,7 @@ ONLY_FOR_ARCHS=	i386 amd64 powerpc power
 
 OPTIONS_DEFINE=	DEBUG GDB_LINK GUILE KGDB PYTHON TUI
 
-OPTIONS_DEFAULT=	GDB_LINK KGDB PYTHON TUI PORT_READLINE
+OPTIONS_DEFAULT=	GDB_LINK PYTHON TUI PORT_READLINE
 
 OPTIONS_SINGLE=	READLINE
 OPTIONS_SINGLE_READLINE=	BASE_READLINE BUNDLED_READLINE PORT_READLINE
@@ -69,26 +69,12 @@ TUI_CONFIGURE_ENABLE=	tui
 
 .include <bsd.port.options.mk>
 
-.if ${OSVERSION} < 1000010
-# FreeBSD 9.x and earlier do not define SIGLIBRT in <sys/signal.h>
-CFLAGS+=	-DSIGLIBRT=33
-.endif
-
-.if ${OSVERSION} > 1000010
-# The option -Wno-extended-offsetof is supported by clang only
-CFLAGS+=	-Wno-extended-offsetof
-.endif
-
 .if ! ${PORT_OPTIONS:MBUNDLED_READLINE}
 EXCLUDE+=	readline
 .endif
 
-.if ${ARCH} == "amd64"
-CONFIGURE_TARGET=	x86_64-portbld-freebsd${OSREL}
-.endif
-
 post-patch:
-	@${REINPLACE_CMD} -e 's|$$| [GDB v${PORTVERSION} for FreeBSD]|' \
+	@${REINPLACE_CMD} -e 's|$$| [GDB v${PORTVERSION} for ${OPSYS}]|' \
 		${WRKSRC}/gdb/version.in
 
 post-patch-KGDB-on:
@@ -116,6 +102,12 @@ do-install-GDB_LINK-on:
 	${LN} -sf kgdb${VER} ${STAGEDIR}${PREFIX}/bin/kgdb
 .endif
 
+dfly-patch:
+	@${CP} ${DFLY_FILESDIR}/dfly64.mh ${WRKSRC}/gdb/config/i386/
+	@${CP} ${DFLY_FILESDIR}/dfly-nat.* ${WRKSRC}/gdb/
+	@${CP} ${DFLY_FILESDIR}/i386* ${WRKSRC}/gdb/
+	@${CP} ${DFLY_FILESDIR}/amd64* ${WRKSRC}/gdb/
+
 do-install-PYTHON-on:
 	(cd ${WRKSRC}/gdb; ${SETENV} ${MAKE_ENV} ${MAKE_CMD} ${MAKE_ARGS} install-python )
 	(cd ${WRKSRC}/gdb/data-directory ; \

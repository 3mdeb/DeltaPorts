--- bsd.options.mk.orig	2012-12-10 11:20:14.000000000 +0100
+++ bsd.options.mk	2013-01-10 18:46:52.874889000 +0100
@@ -46,6 +46,9 @@
 
 OPTIONSFILE?=	${PORT_DBDIR}/${UNIQUENAME}/options
 
+OPTIONS_EXCLUDE_i386+=		ALSA
+OPTIONS_EXCLUDE_x86_64+=	ALSA
+
 #ALL_OPTIONS=	DOCS \
 #		NLS
 
@@ -115,7 +118,7 @@
 optdesc:=	${opt}
 ${optname}_DESC:=	${opt:S|"||g}
 .    else
-.      if ${opt:L} == off
+.      if ${opt:tl} == off
 .        if defined(PORT_OPTIONS) && defined(optname)
 NO_OPTIONS+=	${optname}
 NO_OPTIONS:=	${NO_OPTIONS:O:u}
@@ -137,6 +140,22 @@
 
 ALL_OPTIONS:=	${ALL_OPTIONS:O:u}
 
+# exclude illegal options
+.for opt in ${OPTIONS_EXCLUDE_${ARCH}}
+.  for single in ${OPTIONS_SINGLE}
+OPTIONS_SINGLE_${single}:= ${OPTIONS_SINGLE_${single}:N${opt}}
+.  endfor
+.  for radio in ${OPTIONS_RADIO}
+OPTIONS_RADIO_${radio}:= ${OPTIONS_RADIO_${radio}:N${opt}}
+.  endfor
+.  for multi in ${OPTIONS_MULTI}
+OPTIONS_MULTI_${multi}:= ${OPTIONS_MULTI_${multi}:N${opt}}
+.  endfor
+.  for group in ${OPTIONS_GROUP}
+OPTIONS_GROUP_${group}:= ${OPTIONS_GROUP_${group}:N${opt}}
+.  endfor
+.endfor
+
 # complete list
 COMPLETE_OPTIONS_LIST=	${ALL_OPTIONS}
 .for single in ${OPTIONS_SINGLE}
